<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Copiar Templates</title>
    
    <!-- Firebase compat√≠vel com navegador (v9 compat) -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>

</head>
<body>

    <h1>Copiando Templates...</h1>

    <script>
        // Configura√ß√£o do Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyAKYoUaxhOX1pagezUTTDbwWVg5ktcSEcY",
            authDomain: "templatemaster-a2d6e.firebaseapp.com",
            projectId: "templatemaster-a2d6e",
            storageBucket: "templatemaster-a2d6e.appspot.com",
            messagingSenderId: "208432538664",
            appId: "1:208432538664:web:10a29a55efbb824ae1411d",
            measurementId: "G-LLVT6XW024"
        };

        // Inicializa Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // ID do usu√°rio de origem
        const sourceUserId = "E8yFNf9FaiT62h0sMscAN1EAxRf2";

        async function copyTemplatesToAllUsers() {
            try {
                console.log("üîÑ Iniciando c√≥pia dos templates...");

                // Obt√©m os templates do usu√°rio de origem
                const sourceCollectionRef = db.collection(`users/${sourceUserId}/userTemplates`);
                const sourceSnapshot = await sourceCollectionRef.get();

                if (sourceSnapshot.empty) {
                    console.log("‚ùå Nenhum template encontrado para copiar.");
                    return;
                }

                // Obt√©m todos os usu√°rios do Firestore
                const usersSnapshot = await db.collection("users").get();

                let copiedCount = 0;
                for (const userDoc of usersSnapshot.docs) {
                    const userId = userDoc.id;
                    if (userId === sourceUserId) continue; // Pula o usu√°rio de origem

                    for (const doc of sourceSnapshot.docs) {
                        await db.doc(`users/${userId}/userTemplates/${doc.id}`).set(doc.data());
                    }
                    copiedCount++;
                }

                console.log(`‚úÖ Templates copiados para ${copiedCount} usu√°rios!`);
            } catch (error) {
                console.error("‚ùå Erro ao copiar os templates:", error);
            }
        }

        // Executa a c√≥pia automaticamente ao carregar a p√°gina
        copyTemplatesToAllUsers();
    </script>

</body>
</html>
